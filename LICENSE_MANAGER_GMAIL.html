<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WOLFFX License Manager Pro - Gmail Integration</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #00ff00;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            padding: 30px;
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid #00ff00;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 0 10px #00ff00;
        }

        .header .wolf {
            font-size: 3em;
            display: inline-block;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .alert {
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            border: 2px solid;
        }

        .alert-info {
            background: rgba(0, 255, 255, 0.1);
            border-color: #00ffff;
            color: #00ffff;
        }

        .alert-success {
            background: rgba(0, 255, 0, 0.1);
            border-color: #00ff00;
            color: #00ff00;
        }

        .alert-warning {
            background: rgba(255, 165, 0, 0.1);
            border-color: #ffa500;
            color: #ffa500;
        }

        .alert-danger {
            background: rgba(255, 0, 0, 0.1);
            border-color: #ff0000;
            color: #ff0000;
        }

        .setup-box {
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #ffff00;
            border-radius: 10px;
            padding: 30px;
            margin: 20px 0;
        }

        .setup-step {
            background: rgba(0, 255, 0, 0.05);
            border-left: 4px solid #00ff00;
            padding: 20px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .setup-step h3 {
            color: #ffff00;
            margin-bottom: 10px;
        }

        .setup-step code {
            background: rgba(0, 0, 0, 0.5);
            padding: 5px 10px;
            border-radius: 3px;
            color: #00ffff;
            display: inline-block;
            margin: 5px 0;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 15px 30px;
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid #00ff00;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Courier New', monospace;
            color: #00ff00;
            font-size: 1em;
        }

        .tab:hover {
            background: rgba(0, 255, 0, 0.1);
            transform: translateY(-2px);
        }

        .tab.active {
            background: rgba(0, 255, 0, 0.2);
            border-color: #ffff00;
            box-shadow: 0 0 15px rgba(255, 255, 0, 0.5);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        @media (max-width: 1200px) {
            .grid, .grid-3 {
                grid-template-columns: 1fr;
            }
        }

        .panel {
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #00ff00;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.2);
        }

        .panel-header {
            background: rgba(0, 255, 0, 0.1);
            padding: 15px;
            margin: -20px -20px 20px -20px;
            border-radius: 8px 8px 0 0;
            border-bottom: 2px solid #00ff00;
        }

        .panel-header h2 {
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #00ff88;
            font-weight: bold;
        }

        .input-group input,
        .input-group select,
        .input-group textarea {
            width: 100%;
            padding: 12px;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #00ff00;
            border-radius: 5px;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            font-size: 1em;
        }

        .input-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #00ff00 0%, #00cc00 100%);
            border: none;
            border-radius: 8px;
            color: #000;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Courier New', monospace;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 255, 0, 0.5);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff0000 0%, #cc0000 100%);
            color: #fff;
        }

        .btn-warning {
            background: linear-gradient(135deg, #ffa500 0%, #cc8400 100%);
            color: #000;
        }

        .btn-info {
            background: linear-gradient(135deg, #00ffff 0%, #00cccc 100%);
            color: #000;
        }

        .license-types {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .license-card {
            background: rgba(0, 255, 0, 0.05);
            border: 2px solid #00ff00;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }

        .license-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0, 255, 0, 0.3);
            background: rgba(0, 255, 0, 0.1);
        }

        .license-card.selected {
            background: rgba(0, 255, 0, 0.2);
            border-color: #ffff00;
            box-shadow: 0 0 20px rgba(255, 255, 0, 0.5);
        }

        .license-card h3 {
            font-size: 1.1em;
            margin-bottom: 10px;
            color: #ffff00;
        }

        .license-card .duration {
            color: #00ffff;
            margin-bottom: 10px;
            font-size: 0.9em;
        }

        .license-card .price {
            font-size: 1.3em;
            color: #00ff00;
            font-weight: bold;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .table th,
        .table td {
            padding: 12px;
            border: 1px solid #00ff00;
            text-align: left;
        }

        .table th {
            background: rgba(0, 255, 0, 0.2);
            font-weight: bold;
        }

        .table tr:hover {
            background: rgba(0, 255, 0, 0.05);
        }

        .status-badge {
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.9em;
            font-weight: bold;
        }

        .status-active {
            background: rgba(0, 255, 0, 0.3);
            color: #00ff00;
        }

        .status-expiring {
            background: rgba(255, 165, 0, 0.3);
            color: #ffa500;
        }

        .status-expired {
            background: rgba(255, 0, 0, 0.3);
            color: #ff0000;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-box {
            background: rgba(0, 255, 0, 0.1);
            border: 2px solid #00ff00;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
        }

        .stat-box .number {
            font-size: 2.5em;
            color: #ffff00;
            font-weight: bold;
            display: block;
            margin-bottom: 10px;
        }

        .stat-box .label {
            color: #00ffff;
        }

        .license-key-display {
            background: rgba(255, 255, 0, 0.1);
            border: 2px dashed #ffff00;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin: 20px 0;
        }

        .license-key-display .key {
            font-size: 1.8em;
            color: #ffff00;
            font-weight: bold;
            letter-spacing: 2px;
            text-shadow: 0 0 10px rgba(255, 255, 0, 0.5);
        }

        .search-box {
            width: 100%;
            padding: 12px;
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid #00ff00;
            border-radius: 8px;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            font-size: 1em;
            margin-bottom: 20px;
        }

        .email-status {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 0.8em;
            margin-left: 10px;
        }

        .email-sent {
            background: rgba(0, 255, 0, 0.3);
            color: #00ff00;
        }

        .email-pending {
            background: rgba(255, 165, 0, 0.3);
            color: #ffa500;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0, 255, 0, 0.3);
            border-radius: 50%;
            border-top-color: #00ff00;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: #1a1a2e;
            border: 2px solid #00ff00;
            border-radius: 10px;
            padding: 30px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.5);
        }

        .modal-header {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #ffff00;
        }

        .modal-close {
            float: right;
            font-size: 1.5em;
            cursor: pointer;
            color: #ff0000;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="wolf">üê∫</div>
            <h1>WOLFFX LICENSE MANAGER PRO</h1>
            <p style="color: #00ffff; margin-top: 10px;">Professional License Management with Real Gmail Integration</p>
            <p style="color: #00ff00; margin-top: 5px; font-size: 0.9em;">‚úâÔ∏è aminfx.gh@gmail.com</p>
        </div>

        <!-- Setup Instructions -->
        <div class="alert alert-info" id="setupAlert">
            <strong>‚öôÔ∏è GMAIL SETUP REQUIRED:</strong> Click the "Setup Gmail" tab to configure your email integration. This is a one-time setup!
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <div class="tab active" data-tab="setup">‚öôÔ∏è Setup Gmail</div>
            <div class="tab" data-tab="generator">üîë Generate License</div>
            <div class="tab" data-tab="database">üíæ License Database</div>
            <div class="tab" data-tab="expiring">‚è∞ Expiring Licenses</div>
            <div class="tab" data-tab="statistics">üìä Statistics</div>
        </div>

        <!-- Tab Content: Gmail Setup -->
        <div class="tab-content active" id="setup">
            <div class="panel">
                <div class="panel-header">
                    <h2>üìß Gmail Integration Setup</h2>
                </div>

                <div class="alert alert-warning">
                    <strong>‚ö†Ô∏è Important:</strong> This system uses EmailJS to send emails from your Gmail account (aminfx.gh@gmail.com). Follow these steps to set it up:
                </div>

                <div class="setup-box">
                    <h2 style="color: #ffff00; margin-bottom: 20px;">üöÄ Quick Setup Guide (5 Minutes)</h2>

                    <div class="setup-step">
                        <h3>Step 1: Create EmailJS Account</h3>
                        <p>1. Go to <a href="https://www.emailjs.com/" target="_blank" style="color: #00ffff;">https://www.emailjs.com/</a></p>
                        <p>2. Click "Sign Up Free"</p>
                        <p>3. Choose "Sign Up with Google" and use <code>aminfx.gh@gmail.com</code></p>
                        <p>4. Complete registration (free plan allows 200 emails/month)</p>
                    </div>

                    <div class="setup-step">
                        <h3>Step 2: Add Email Service</h3>
                        <p>1. After logging in, click "Add New Service"</p>
                        <p>2. Select "Gmail"</p>
                        <p>3. Click "Connect Account" and authorize with <code>aminfx.gh@gmail.com</code></p>
                        <p>4. Copy your <strong>Service ID</strong> (looks like: service_xxxxxxx)</p>
                    </div>

                    <div class="setup-step">
                        <h3>Step 3: Create Email Template</h3>
                        <p>1. Go to "Email Templates" ‚Üí "Create New Template"</p>
                        <p>2. Template Name: <code>WOLFFX License Email</code></p>
                        <p>3. Copy this template content:</p>
                        <textarea readonly style="width: 100%; margin: 10px 0; padding: 10px; background: rgba(0,0,0,0.5); color: #00ff00; border: 1px solid #00ff00; border-radius: 5px;" rows="20">
Subject: Your WOLFFX EA License - {{customer_name}}

Dear {{customer_name}},

Thank you for purchasing WOLFFX EA! Your license has been generated successfully.

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
LICENSE DETAILS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

License Key: {{license_key}}
License Type: {{license_type}}
Account Number: {{account_number}}
Broker: {{broker}}
Server: {{server}}
Valid Until: {{expiry_date}}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
ACTIVATION INSTRUCTIONS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

1. Open MetaTrader 5
2. Load WOLFFX EA on your chart
3. Enter these settings:
   - LICENSE_KEY: {{license_key}}
   - CUSTOMER_NAME: {{customer_name}}
   - ACCOUNT_NUMBER: {{account_number}}

4. Click OK to activate

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

For support, contact us at: aminfx.gh@gmail.com

Best regards,
WOLFFX Trading Academy
https://wolffxtradingacademy.com
                        </textarea>
                        <p>4. <strong style="color: #ffff00;">IMPORTANT:</strong> In EmailJS template settings:</p>
                        <p style="margin-left: 20px;">‚Ä¢ Set "To email" field to: <code>{{customer_email}}</code></p>
                        <p style="margin-left: 20px;">‚Ä¢ This ensures email goes to customer, not you</p>
                        <p>5. Save the template</p>
                        <p>6. Copy your <strong>Template ID</strong> (looks like: template_xxxxxxx)</p>
                    </div>

                    <div class="setup-step">
                        <h3>Step 4: Get Public Key</h3>
                        <p>1. Go to "Account" ‚Üí "General"</p>
                        <p>2. Copy your <strong>Public Key</strong> (looks like: xxxxxxxxxxxx)</p>
                    </div>

                    <div class="setup-step">
                        <h3>Step 5: Configure Below</h3>
                        <p>Enter all three credentials you copied above:</p>
                    </div>

                    <div class="setup-step" style="background: rgba(255, 165, 0, 0.1); border-left-color: #ffa500;">
                        <h3>‚ö†Ô∏è Common Issues & Solutions</h3>
                        <p><strong>Error: "Email failed"</strong></p>
                        <p style="margin-left: 20px;">‚úì Check that Service ID, Template ID, and Public Key are correct</p>
                        <p style="margin-left: 20px;">‚úì In EmailJS template, set "To email" to: <code>{{customer_email}}</code> or <code>{{to_email}}</code></p>
                        <p style="margin-left: 20px;">‚úì Make sure template variables use double curly braces: <code>{{customer_name}}</code></p>
                        <p style="margin-left: 20px;">‚úì Verify your EmailJS service is connected to Gmail</p>
                        <p><strong>Error: "Unauthorized"</strong></p>
                        <p style="margin-left: 20px;">‚úì Your Public Key is incorrect - copy it again from EmailJS Account settings</p>
                        <p><strong>Test Email Not Received</strong></p>
                        <p style="margin-left: 20px;">‚úì Check spam folder</p>
                        <p style="margin-left: 20px;">‚úì Wait 1-2 minutes (sometimes delayed)</p>
                        <p style="margin-left: 20px;">‚úì Check EmailJS dashboard for error logs</p>
                    </div>
                </div>

                <div class="input-group">
                    <label>üìß Your Gmail Address:</label>
                    <input type="email" id="gmailAddress" value="aminfx.gh@gmail.com" readonly>
                </div>

                <div class="input-group">
                    <label>üîë EmailJS Public Key:</label>
                    <input type="text" id="emailjsPublicKey" placeholder="Your_Public_Key_Here">
                    <small style="color: #00ffff;">From EmailJS Account ‚Üí General</small>
                </div>

                <div class="input-group">
                    <label>üîß EmailJS Service ID:</label>
                    <input type="text" id="emailjsServiceId" placeholder="service_xxxxxxx">
                    <small style="color: #00ffff;">From EmailJS Email Services</small>
                </div>

                <div class="input-group">
                    <label>üìù EmailJS Template ID:</label>
                    <input type="text" id="emailjsTemplateId" placeholder="template_xxxxxxx">
                    <small style="color: #00ffff;">From EmailJS Email Templates</small>
                </div>

                <button class="btn" id="saveEmailConfigBtn">üíæ Save Configuration</button>
                <button class="btn btn-info" id="testGmailBtn" disabled>üìß Send Test Email</button>

                <div id="emailConfigStatus" style="margin-top: 20px;"></div>

                <div class="alert alert-info" style="margin-top: 20px;">
                    <strong>üí° Pro Tip:</strong> After setup, you can send up to 200 emails per month for free. For higher volume, upgrade to EmailJS paid plan or integrate with SendGrid/Mailgun.
                </div>
            </div>
        </div>

        <!-- Tab Content: Generator -->
        <div class="tab-content" id="generator">
            <div class="grid">
                <div class="panel">
                    <div class="panel-header">
                        <h2>‚öôÔ∏è Customer Information</h2>
                    </div>

                    <div class="input-group">
                        <label>üë§ Customer Name:</label>
                        <input type="text" id="customerName" value="John Doe">
                    </div>

                    <div class="input-group">
                        <label>üìß Customer Email:</label>
                        <input type="email" id="customerEmail" value="customer@example.com">
                    </div>

                    <div class="input-group">
                        <label>üí≥ MT5 Account Number:</label>
                        <input type="text" id="accountNumber" value="12345678">
                    </div>

                    <div class="input-group">
                        <label>üè¶ Broker Name:</label>
                        <input type="text" id="broker" value="IC Markets">
                    </div>

                    <div class="input-group">
                        <label>üåê Server Name:</label>
                        <input type="text" id="server" value="ICMarkets-Demo">
                    </div>

                    <div class="input-group">
                        <label>üìù Notes (Optional):</label>
                        <textarea id="notes" placeholder="Additional customer notes..."></textarea>
                    </div>

                    <button class="btn" id="generateBtn">üîë GENERATE & SAVE LICENSE</button>
                    <button class="btn btn-info" id="generateWithEmailBtn" disabled>üìß GENERATE & EMAIL VIA GMAIL</button>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        <h2>üíé Select License Type</h2>
                    </div>

                    <div class="license-types">
                        <div class="license-card" data-type="WEEKLY">
                            <h3>WEEKLY</h3>
                            <div class="duration">7 Days</div>
                            <div class="price">$50</div>
                        </div>
                        <div class="license-card" data-type="MONTHLY">
                            <h3>MONTHLY</h3>
                            <div class="duration">30 Days</div>
                            <div class="price">$99</div>
                        </div>
                        <div class="license-card" data-type="QUARTERLY">
                            <h3>QUARTERLY</h3>
                            <div class="duration">90 Days</div>
                            <div class="price">$249</div>
                        </div>
                        <div class="license-card selected" data-type="ANNUAL">
                            <h3>ANNUAL</h3>
                            <div class="duration">365 Days</div>
                            <div class="price">$799</div>
                        </div>
                        <div class="license-card" data-type="LIFETIME">
                            <h3>LIFETIME</h3>
                            <div class="duration">Forever</div>
                            <div class="price">$1,999</div>
                        </div>
                    </div>

                    <div class="alert alert-info">
                        <strong>Selected:</strong> <span id="selectedType">ANNUAL (365 days) - $799</span>
                    </div>

                    <div class="alert alert-success" id="generationResult" style="display: none;">
                        <div class="license-key-display">
                            <div style="margin-bottom: 10px;">License Key Generated:</div>
                            <div class="key" id="generatedKey"></div>
                            <button class="btn btn-info" style="margin-top: 15px;" id="copyKeyBtn">üìã COPY KEY</button>
                        </div>
                        <div id="emailSendStatus" style="margin-top: 15px;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab Content: Database -->
        <div class="tab-content" id="database">
            <div class="panel">
                <div class="panel-header">
                    <h2>üíæ License Database</h2>
                </div>

                <input type="text" id="searchBox" class="search-box" placeholder="üîç Search by name, email, account number, or license key...">

                <div style="margin-bottom: 20px;">
                    <button class="btn" id="exportCSVBtn">üì• Export Excel</button>
                    <button class="btn btn-warning" id="checkExpiriesBtn">‚è∞ Check Expiries</button>
                    <button class="btn btn-danger" id="clearDatabaseBtn">üóëÔ∏è Clear All Data</button>
                </div>

                <div style="overflow-x: auto;">
                    <table class="table" id="licenseTable">
                        <thead>
                            <tr>
                                <th>Customer</th>
                                <th>Email</th>
                                <th>Account</th>
                                <th>License Key</th>
                                <th>Type</th>
                                <th>Status</th>
                                <th>Expires In</th>
                                <th>Email Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="licenseTableBody">
                            <tr>
                                <td colspan="9" style="text-align: center; padding: 40px;">
                                    No licenses generated yet. Create your first license in the Generator tab.
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Tab Content: Expiring Licenses -->
        <div class="tab-content" id="expiring">
            <div class="grid-3">
                <div class="panel">
                    <div class="panel-header">
                        <h2>‚ö†Ô∏è Expiring Soon (7 days)</h2>
                    </div>
                    <div id="expiringSoonList" style="min-height: 200px;">
                        <div class="alert alert-info">No licenses expiring in the next 7 days</div>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        <h2>üî¥ Expired Licenses</h2>
                    </div>
                    <div id="expiredList" style="min-height: 200px;">
                        <div class="alert alert-info">No expired licenses</div>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        <h2>üìß Email Queue</h2>
                    </div>
                    <div id="emailQueueList" style="min-height: 200px;">
                        <div class="alert alert-info">Email queue is empty</div>
                    </div>
                    <button class="btn" id="sendAllRemindersBtn" style="width: 100%; margin-top: 15px;" disabled>üìß Send All Reminder Emails</button>
                </div>
            </div>
        </div>

        <!-- Tab Content: Statistics -->
        <div class="tab-content" id="statistics">
            <div class="panel">
                <div class="panel-header">
                    <h2>üìä System Statistics</h2>
                </div>

                <div class="stats-grid">
                    <div class="stat-box">
                        <span class="number" id="totalLicenses">0</span>
                        <span class="label">Total Licenses</span>
                    </div>
                    <div class="stat-box">
                        <span class="number" id="activeLicenses">0</span>
                        <span class="label">Active Licenses</span>
                    </div>
                    <div class="stat-box">
                        <span class="number" id="expiringLicenses">0</span>
                        <span class="label">Expiring Soon</span>
                    </div>
                    <div class="stat-box">
                        <span class="number" id="expiredLicenses">0</span>
                        <span class="label">Expired</span>
                    </div>
                    <div class="stat-box">
                        <span class="number" id="totalRevenue">$0</span>
                        <span class="label">Total Revenue</span>
                    </div>
                    <div class="stat-box">
                        <span class="number" id="emailsSent">0</span>
                        <span class="label">Emails Sent</span>
                    </div>
                </div>

                <div class="panel" style="margin-top: 20px;">
                    <div class="panel-header">
                        <h2>üìà License Type Distribution</h2>
                    </div>
                    <div id="licenseDistribution"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- EmailJS SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <script>
        // Global variables
        let selectedLicense = 'ANNUAL';
        let licenses = [];
        let emailConfig = {
            configured: false,
            publicKey: '',
            serviceId: '',
            templateId: '',
            gmail: 'aminfx.gh@gmail.com'
        };

        const licenseConfig = {
            WEEKLY: { code: 'W', duration: '7 days', price: 50, days: 7 },
            MONTHLY: { code: 'M', duration: '30 days', price: 99, days: 30 },
            QUARTERLY: { code: 'Q', duration: '90 days', price: 249, days: 90 },
            ANNUAL: { code: 'A', duration: '365 days', price: 799, days: 365 },
            LIFETIME: { code: 'L', duration: 'Forever', price: 1999, days: 36500 }
        };

        // Load data from localStorage
        function loadData() {
            const savedLicenses = localStorage.getItem('wolffx_licenses');
            if (savedLicenses) {
                licenses = JSON.parse(savedLicenses);
            }

            const savedConfig = localStorage.getItem('wolffx_email_config');
            if (savedConfig) {
                emailConfig = JSON.parse(savedConfig);
                document.getElementById('emailjsPublicKey').value = emailConfig.publicKey || '';
                document.getElementById('emailjsServiceId').value = emailConfig.serviceId || '';
                document.getElementById('emailjsTemplateId').value = emailConfig.templateId || '';
                
                if (emailConfig.configured) {
                    initializeEmailJS();
                    updateEmailButtons(true);
                    document.getElementById('setupAlert').style.display = 'none';
                }
            }
        }

        // Save data
        function saveData() {
            localStorage.setItem('wolffx_licenses', JSON.stringify(licenses));
        }

        // Initialize EmailJS
        function initializeEmailJS() {
            if (emailConfig.publicKey) {
                emailjs.init(emailConfig.publicKey);
                console.log('‚úÖ EmailJS initialized');
            }
        }

        // Update email button states
        function updateEmailButtons(enabled) {
            document.getElementById('generateWithEmailBtn').disabled = !enabled;
            document.getElementById('testGmailBtn').disabled = !enabled;
            document.getElementById('sendAllRemindersBtn').disabled = !enabled;
        }

        // Save email configuration
        function saveEmailConfig() {
            const publicKey = document.getElementById('emailjsPublicKey').value.trim();
            const serviceId = document.getElementById('emailjsServiceId').value.trim();
            const templateId = document.getElementById('emailjsTemplateId').value.trim();

            if (!publicKey || !serviceId || !templateId) {
                alert('‚ùå Please fill in all three fields:\n- Public Key\n- Service ID\n- Template ID');
                return;
            }

            emailConfig = {
                configured: true,
                publicKey: publicKey,
                serviceId: serviceId,
                templateId: templateId,
                gmail: 'aminfx.gh@gmail.com'
            };

            localStorage.setItem('wolffx_email_config', JSON.stringify(emailConfig));
            initializeEmailJS();
            updateEmailButtons(true);

            document.getElementById('emailConfigStatus').innerHTML = 
                '<div class="alert alert-success">‚úÖ Gmail integration configured successfully! You can now send emails from aminfx.gh@gmail.com</div>';
            
            document.getElementById('setupAlert').style.display = 'none';
            
            setTimeout(() => {
                switchTab('generator');
            }, 2000);
        }

        // Send test email
        function sendTestEmail() {
            if (!emailConfig.configured) {
                alert('‚ùå Please configure email settings first');
                return;
            }

            const statusDiv = document.getElementById('emailConfigStatus');
            statusDiv.innerHTML = '<div class="alert alert-info">üìß Sending test email... <span class="loading"></span></div>';

            const testParams = {
                to_name: 'Test Customer',
                customer_name: 'Test Customer',
                customer_email: emailConfig.gmail, // Send to your own Gmail
                to_email: emailConfig.gmail,
                license_key: 'WOLF-TEST-1234-5678-9012',
                license_type: 'ANNUAL (365 days) - $799',
                account_number: '12345678',
                broker: 'Test Broker',
                server: 'Test Server',
                expiry_date: new Date(Date.now() + 365 * 24 * 60 * 60 * 1000).toLocaleDateString()
            };

            console.log('Test email params:', testParams);
            console.log('Service ID:', emailConfig.serviceId);
            console.log('Template ID:', emailConfig.templateId);

            emailjs.send(emailConfig.serviceId, emailConfig.templateId, testParams)
                .then(function(response) {
                    console.log('‚úÖ Test email sent', response);
                    statusDiv.innerHTML = '<div class="alert alert-success">‚úÖ Test email sent successfully to ' + emailConfig.gmail + '!<br><br>Check your inbox (and spam folder). Email should arrive within 1-2 minutes.</div>';
                }, function(error) {
                    console.error('‚ùå Email failed', error);
                    let errorMessage = 'Unknown error';
                    if (error && error.text) {
                        errorMessage = error.text;
                    } else if (error && error.message) {
                        errorMessage = error.message;
                    }
                    statusDiv.innerHTML = '<div class="alert alert-danger">‚ùå Failed to send test email<br><br><strong>Error:</strong> ' + errorMessage + '<br><br><strong>Troubleshooting:</strong><br>1. Check that all three credentials are correct<br>2. Verify EmailJS template has "To email" set to {{customer_email}} or {{to_email}}<br>3. Make sure your Gmail service is connected in EmailJS<br>4. Check EmailJS dashboard for error logs</div>';
                });
        }

        // Generate random characters
        function generateRandomChars(length) {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let result = '';
            for (let i = 0; i < length; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        // Generate license key
        function generateLicenseKey(type) {
            const config = licenseConfig[type];
            return 'WOLF-' + config.code + generateRandomChars(3) + '-' + 
                   generateRandomChars(4) + '-' + generateRandomChars(4) + '-' + 
                   generateRandomChars(4);
        }

        // Calculate expiry date
        function calculateExpiryDate(days) {
            const now = new Date();
            return new Date(now.getTime() + (days * 24 * 60 * 60 * 1000));
        }

        // Get days until expiry
        function getDaysUntilExpiry(expiryDate) {
            const now = new Date();
            const expiry = new Date(expiryDate);
            const diff = expiry - now;
            return Math.ceil(diff / (1000 * 60 * 60 * 24));
        }

        // Get license status
        function getLicenseStatus(license) {
            if (license.type === 'LIFETIME') return 'active';
            
            const daysLeft = getDaysUntilExpiry(license.expiryDate);
            
            if (daysLeft < 0) return 'expired';
            if (daysLeft <= 7) return 'expiring';
            return 'active';
        }

        // Format countdown
        function formatCountdown(expiryDate, type) {
            if (type === 'LIFETIME') return 'Never (Lifetime)';
            
            const daysLeft = getDaysUntilExpiry(expiryDate);
            
            if (daysLeft < 0) {
                return '<span style="color: #ff0000;">EXPIRED ' + Math.abs(daysLeft) + ' days ago</span>';
            } else if (daysLeft === 0) {
                return '<span style="color: #ff0000;">EXPIRES TODAY</span>';
            } else if (daysLeft === 1) {
                return '<span style="color: #ffa500;">1 day left</span>';
            } else if (daysLeft <= 7) {
                return '<span style="color: #ffa500;">' + daysLeft + ' days left</span>';
            } else {
                return daysLeft + ' days left';
            }
        }

        // Select license type
        function selectLicense(type) {
            selectedLicense = type;
            
            const cards = document.querySelectorAll('.license-card');
            cards.forEach(card => card.classList.remove('selected'));
            
            const selectedCard = document.querySelector('[data-type="' + type + '"]');
            if (selectedCard) {
                selectedCard.classList.add('selected');
            }
            
            const config = licenseConfig[type];
            document.getElementById('selectedType').textContent = 
                type + ' (' + config.duration + ') - $' + config.price;
        }

        // Send license email via Gmail
        function sendLicenseEmail(license, statusCallback) {
            if (!emailConfig.configured) {
                if (statusCallback) statusCallback(false, 'Email not configured');
                return;
            }

            const emailParams = {
                to_name: license.customerName,
                customer_name: license.customerName,
                customer_email: license.email,
                to_email: license.email,
                license_key: license.licenseKey,
                license_type: license.type + ' (' + licenseConfig[license.type].duration + ') - $' + license.price,
                account_number: license.accountNumber,
                broker: license.broker,
                server: license.server,
                expiry_date: new Date(license.expiryDate).toLocaleDateString()
            };

            console.log('Sending email with params:', emailParams);

            emailjs.send(emailConfig.serviceId, emailConfig.templateId, emailParams)
                .then(function(response) {
                    console.log('‚úÖ Email sent successfully', response);
                    license.emailSent = true;
                    license.emailSentDate = new Date().toISOString();
                    saveData();
                    if (statusCallback) statusCallback(true, 'Email sent successfully');
                }, function(error) {
                    console.error('‚ùå Email error:', error);
                    let errorMessage = 'Email failed';
                    if (error && error.text) {
                        errorMessage = error.text;
                    } else if (error && error.message) {
                        errorMessage = error.message;
                    } else if (typeof error === 'string') {
                        errorMessage = error;
                    }
                    if (statusCallback) statusCallback(false, errorMessage);
                });
        }

        // Generate and save license
        function generateAndSaveLicense(sendEmail) {
            const customerName = document.getElementById('customerName').value.trim();
            const email = document.getElementById('customerEmail').value.trim();
            const accountNumber = document.getElementById('accountNumber').value.trim();
            const broker = document.getElementById('broker').value.trim();
            const server = document.getElementById('server').value.trim();
            const notes = document.getElementById('notes').value.trim();

            if (!customerName || !email || !accountNumber) {
                alert('‚ùå Please fill in all required fields:\n- Customer Name\n- Customer Email\n- Account Number');
                return;
            }

            const config = licenseConfig[selectedLicense];
            const licenseKey = generateLicenseKey(selectedLicense);
            const expiryDate = calculateExpiryDate(config.days);

            const license = {
                id: Date.now(),
                customerName: customerName,
                email: email,
                accountNumber: accountNumber,
                broker: broker,
                server: server,
                notes: notes,
                licenseKey: licenseKey,
                type: selectedLicense,
                price: config.price,
                generatedDate: new Date().toISOString(),
                expiryDate: expiryDate.toISOString(),
                emailSent: false,
                reminderSent: false
            };

            licenses.push(license);
            saveData();

            // Show generated key
            document.getElementById('generatedKey').textContent = licenseKey;
            document.getElementById('generationResult').style.display = 'block';

            const emailStatusDiv = document.getElementById('emailSendStatus');

            // Send email if requested
            if (sendEmail) {
                emailStatusDiv.innerHTML = '<div class="alert alert-info">üìß Sending email to ' + email + '... <span class="loading"></span></div>';
                
                sendLicenseEmail(license, function(success, message) {
                    if (success) {
                        emailStatusDiv.innerHTML = '<div class="alert alert-success">‚úÖ ' + message + ' to ' + email + '</div>';
                    } else {
                        emailStatusDiv.innerHTML = '<div class="alert alert-danger">‚ùå ' + message + '</div>';
                    }
                    updateLicenseTable();
                    updateStatistics();
                });
            } else {
                emailStatusDiv.innerHTML = '';
            }

            // Refresh displays
            updateLicenseTable();
            updateStatistics();
            updateExpiringLists();

            alert('‚úÖ License generated and saved!\n\nCustomer: ' + customerName + '\nLicense Key: ' + licenseKey + '\n\n' + (sendEmail ? 'Email will be sent to: ' + email : 'Email not sent (save only)'));
        }

        // Update license table
        function updateLicenseTable(searchTerm) {
            const tbody = document.getElementById('licenseTableBody');
            tbody.innerHTML = '';

            let filteredLicenses = licenses;
            
            if (searchTerm) {
                const term = searchTerm.toLowerCase();
                filteredLicenses = licenses.filter(l => 
                    l.customerName.toLowerCase().includes(term) ||
                    l.email.toLowerCase().includes(term) ||
                    l.accountNumber.toLowerCase().includes(term) ||
                    l.licenseKey.toLowerCase().includes(term)
                );
            }

            if (filteredLicenses.length === 0) {
                tbody.innerHTML = '<tr><td colspan="9" style="text-align: center; padding: 40px;">No licenses found</td></tr>';
                return;
            }

            filteredLicenses.reverse().forEach(license => {
                const status = getLicenseStatus(license);
                const statusClass = 'status-' + status;
                const statusText = status.charAt(0).toUpperCase() + status.slice(1);
                const emailStatus = license.emailSent ? 
                    '<span class="email-status email-sent">‚úÖ Sent</span>' : 
                    '<span class="email-status email-pending">‚è≥ Pending</span>';

                const row = document.createElement('tr');
                row.innerHTML = 
                    '<td>' + license.customerName + '</td>' +
                    '<td>' + license.email + '</td>' +
                    '<td>' + license.accountNumber + '</td>' +
                    '<td style="font-size: 0.8em;">' + license.licenseKey + '</td>' +
                    '<td>' + license.type + '</td>' +
                    '<td><span class="status-badge ' + statusClass + '">' + statusText + '</span></td>' +
                    '<td>' + formatCountdown(license.expiryDate, license.type) + '</td>' +
                    '<td>' + emailStatus + '</td>' +
                    '<td>' +
                        '<button class="btn" onclick="resendEmail(' + license.id + ')" style="padding: 5px 10px; font-size: 0.9em; margin: 2px;" ' + (!emailConfig.configured ? 'disabled' : '') + '>üìß Resend</button>' +
                        '<button class="btn btn-warning" onclick="renewLicense(' + license.id + ')" style="padding: 5px 10px; font-size: 0.9em; margin: 2px;">üîÑ Renew</button>' +
                        '<button class="btn btn-danger" onclick="deleteLicense(' + license.id + ')" style="padding: 5px 10px; font-size: 0.9em; margin: 2px;">üóëÔ∏è</button>' +
                    '</td>';
                tbody.appendChild(row);
            });
        }

        // Resend email
        function resendEmail(id) {
            const license = licenses.find(l => l.id === id);
            if (!license) return;

            if (confirm('Resend license email to ' + license.email + '?')) {
                sendLicenseEmail(license, function(success, message) {
                    if (success) {
                        alert('‚úÖ Email sent successfully to ' + license.email);
                    } else {
                        alert('‚ùå ' + message);
                    }
                    updateLicenseTable();
                    updateStatistics();
                });
            }
        }

        // Renew license
        function renewLicense(id) {
            const license = licenses.find(l => l.id === id);
            if (!license) return;

            if (confirm('Generate a new license for ' + license.customerName + '?\n\nThis will create a fresh license with a new key and expiry date.')) {
                const config = licenseConfig[license.type];
                const newLicenseKey = generateLicenseKey(license.type);
                const newExpiryDate = calculateExpiryDate(config.days);

                const newLicense = {
                    id: Date.now(),
                    customerName: license.customerName,
                    email: license.email,
                    accountNumber: license.accountNumber,
                    broker: license.broker,
                    server: license.server,
                    notes: 'Renewed from license: ' + license.licenseKey,
                    licenseKey: newLicenseKey,
                    type: license.type,
                    price: config.price,
                    generatedDate: new Date().toISOString(),
                    expiryDate: newExpiryDate.toISOString(),
                    emailSent: false,
                    reminderSent: false
                };

                licenses.push(newLicense);
                saveData();
                
                updateLicenseTable();
                updateStatistics();
                updateExpiringLists();

                if (emailConfig.configured) {
                    if (confirm('‚úÖ New license generated!\n\nNew License Key: ' + newLicenseKey + '\n\nSend email to customer?')) {
                        sendLicenseEmail(newLicense, function(success) {
                            if (success) {
                                alert('‚úÖ Renewal email sent to ' + license.email);
                            }
                            updateLicenseTable();
                        });
                    }
                } else {
                    alert('‚úÖ New license generated!\n\nNew License Key: ' + newLicenseKey + '\n\nExpires: ' + new Date(newExpiryDate).toLocaleDateString());
                }
            }
        }

        // Delete license
        function deleteLicense(id) {
            const license = licenses.find(l => l.id === id);
            if (!license) return;

            if (confirm('Delete this license?\n\nCustomer: ' + license.customerName + '\nLicense: ' + license.licenseKey)) {
                licenses = licenses.filter(l => l.id !== id);
                saveData();
                updateLicenseTable();
                updateStatistics();
                updateExpiringLists();
            }
        }

        // Update statistics
        function updateStatistics() {
            const total = licenses.length;
            let active = 0;
            let expiring = 0;
            let expired = 0;
            let totalRevenue = 0;
            let emailsSent = 0;

            const distribution = {
                WEEKLY: 0,
                MONTHLY: 0,
                QUARTERLY: 0,
                ANNUAL: 0,
                LIFETIME: 0
            };

            licenses.forEach(license => {
                const status = getLicenseStatus(license);
                if (status === 'active') active++;
                else if (status === 'expiring') expiring++;
                else if (status === 'expired') expired++;

                totalRevenue += license.price;
                distribution[license.type]++;
                if (license.emailSent) emailsSent++;
            });

            document.getElementById('totalLicenses').textContent = total;
            document.getElementById('activeLicenses').textContent = active;
            document.getElementById('expiringLicenses').textContent = expiring;
            document.getElementById('expiredLicenses').textContent = expired;
            document.getElementById('totalRevenue').textContent = '$' + totalRevenue.toLocaleString();
            document.getElementById('emailsSent').textContent = emailsSent;

            // Update distribution
            const distDiv = document.getElementById('licenseDistribution');
            let distHtml = '';
            Object.keys(distribution).forEach(type => {
                const count = distribution[type];
                const percentage = total > 0 ? Math.round((count / total) * 100) : 0;
                distHtml += '<div style="margin: 10px 0;">' +
                    '<div style="display: flex; justify-content: space-between; margin-bottom: 5px;">' +
                    '<span>' + type + '</span>' +
                    '<span>' + count + ' (' + percentage + '%)</span>' +
                    '</div>' +
                    '<div style="background: rgba(0,0,0,0.5); height: 20px; border-radius: 10px; overflow: hidden;">' +
                    '<div style="background: linear-gradient(90deg, #00ff00, #00cc00); height: 100%; width: ' + percentage + '%;"></div>' +
                    '</div>' +
                    '</div>';
            });
            distDiv.innerHTML = distHtml;
        }

        // Update expiring lists
        function updateExpiringLists() {
            const expiringSoon = [];
            const expired = [];
            const emailQueue = [];

            licenses.forEach(license => {
                const status = getLicenseStatus(license);
                const daysLeft = getDaysUntilExpiry(license.expiryDate);

                if (status === 'expiring') {
                    expiringSoon.push(license);
                    if (!license.reminderSent && daysLeft <= 7) {
                        emailQueue.push(license);
                    }
                } else if (status === 'expired') {
                    expired.push(license);
                }
            });

            // Update expiring soon
            const expiringSoonDiv = document.getElementById('expiringSoonList');
            if (expiringSoon.length === 0) {
                expiringSoonDiv.innerHTML = '<div class="alert alert-info">No licenses expiring in the next 7 days</div>';
            } else {
                let html = '';
                expiringSoon.forEach(license => {
                    const daysLeft = getDaysUntilExpiry(license.expiryDate);
                    html += '<div class="alert alert-warning" style="margin: 10px 0;">' +
                        '<strong>' + license.customerName + '</strong><br>' +
                        'Email: ' + license.email + '<br>' +
                        'Account: ' + license.accountNumber + '<br>' +
                        'Expires in: <strong>' + daysLeft + ' days</strong><br>' +
                        '<button class="btn btn-warning" onclick="resendEmail(' + license.id + ')" style="margin-top: 10px; padding: 5px 15px; font-size: 0.9em;" ' + (!emailConfig.configured ? 'disabled' : '') + '>üìß Send Reminder</button>' +
                        '</div>';
                });
                expiringSoonDiv.innerHTML = html;
            }

            // Update expired
            const expiredDiv = document.getElementById('expiredList');
            if (expired.length === 0) {
                expiredDiv.innerHTML = '<div class="alert alert-info">No expired licenses</div>';
            } else {
                let html = '';
                expired.forEach(license => {
                    const daysAgo = Math.abs(getDaysUntilExpiry(license.expiryDate));
                    html += '<div class="alert alert-danger" style="margin: 10px 0;">' +
                        '<strong>' + license.customerName + '</strong><br>' +
                        'Email: ' + license.email + '<br>' +
                        'Account: ' + license.accountNumber + '<br>' +
                        'Expired: <strong>' + daysAgo + ' days ago</strong><br>' +
                        '<button class="btn" onclick="renewLicense(' + license.id + ')" style="margin-top: 10px; padding: 5px 15px; font-size: 0.9em;">üîÑ Generate Renewal</button>' +
                        '</div>';
                });
                expiredDiv.innerHTML = html;
            }

            // Update email queue
            const emailQueueDiv = document.getElementById('emailQueueList');
            if (emailQueue.length === 0) {
                emailQueueDiv.innerHTML = '<div class="alert alert-info">Email queue is empty</div>';
            } else {
                let html = '';
                emailQueue.forEach(license => {
                    const daysLeft = getDaysUntilExpiry(license.expiryDate);
                    html += '<div class="alert alert-info" style="margin: 10px 0;">' +
                        '<strong>' + license.customerName + '</strong><br>' +
                        'Email: ' + license.email + '<br>' +
                        'Days left: <strong>' + daysLeft + '</strong>' +
                        '</div>';
                });
                emailQueueDiv.innerHTML = html;
            }
        }

        // Export to CSV
        function exportToCSV() {
            if (licenses.length === 0) {
                alert('No licenses to export');
                return;
            }

            const ws = XLSX.utils.json_to_sheet(licenses.map(l => ({
                'Customer Name': l.customerName,
                'Email': l.email,
                'Account Number': l.accountNumber,
                'Broker': l.broker,
                'Server': l.server,
                'License Key': l.licenseKey,
                'Type': l.type,
                'Price': l.price,
                'Generated Date': new Date(l.generatedDate).toLocaleString(),
                'Expiry Date': new Date(l.expiryDate).toLocaleString(),
                'Status': getLicenseStatus(l),
                'Days Left': getDaysUntilExpiry(l.expiryDate),
                'Email Sent': l.emailSent ? 'Yes' : 'No',
                'Notes': l.notes || ''
            })));

            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Licenses');
            XLSX.writeFile(wb, 'WOLFFX_Licenses_' + new Date().toISOString().split('T')[0] + '.xlsx');

            alert('‚úÖ Licenses exported successfully!');
        }

        // Clear all data
        function clearAllData() {
            if (confirm('‚ö†Ô∏è WARNING: Delete ALL ' + licenses.length + ' license records?\n\nThis cannot be undone!')) {
                if (confirm('FINAL CONFIRMATION: Delete everything?')) {
                    licenses = [];
                    saveData();
                    updateLicenseTable();
                    updateStatistics();
                    updateExpiringLists();
                    alert('‚úÖ All data cleared');
                }
            }
        }

        // Check expiries
        function checkExpiries() {
            updateExpiringLists();
            alert('‚úÖ Expiry check complete');
        }

        // Copy license key
        function copyLicenseKey() {
            const key = document.getElementById('generatedKey').textContent;
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(key).then(function() {
                    alert('‚úÖ License key copied!\n\n' + key);
                });
            }
        }

        // Switch tab
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            document.querySelector('[data-tab="' + tabName + '"]').classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // Initialize
        window.addEventListener('load', function() {
            console.log('üê∫ WOLFFX License Manager Pro - Gmail Edition Loaded');

            loadData();
            updateLicenseTable();
            updateStatistics();
            updateExpiringLists();

            // Tab switching
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    switchTab(this.dataset.tab);
                });
            });

            // License card selection
            document.querySelectorAll('.license-card').forEach(card => {
                card.addEventListener('click', function() {
                    selectLicense(this.dataset.type);
                });
            });

            // Email configuration
            document.getElementById('saveEmailConfigBtn').addEventListener('click', saveEmailConfig);
            document.getElementById('testGmailBtn').addEventListener('click', sendTestEmail);

            // Generate buttons
            document.getElementById('generateBtn').addEventListener('click', function() {
                generateAndSaveLicense(false);
            });

            document.getElementById('generateWithEmailBtn').addEventListener('click', function() {
                generateAndSaveLicense(true);
            });

            document.getElementById('copyKeyBtn').addEventListener('click', copyLicenseKey);

            // Database actions
            document.getElementById('searchBox').addEventListener('input', function() {
                updateLicenseTable(this.value);
            });

            document.getElementById('exportCSVBtn').addEventListener('click', exportToCSV);
            document.getElementById('checkExpiriesBtn').addEventListener('click', checkExpiries);
            document.getElementById('clearDatabaseBtn').addEventListener('click', clearAllData);

            console.log('‚úÖ System ready. Loaded', licenses.length, 'licenses');
        });
    </script>
</body>
</html>
